format_version: 4
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git

app:
  envs:
    - FOLDERS: $FOLDERS
    - PATH_CONFIGURATION: $PATH_CONFIGURATION
    - JIRA_KEYS: $JIRA_KEYS
    - BRANCH: $BRANCH
    - AUTHOR: $AUTHOR
    - PR: $PR
    - BITRISE_STEP_ID: alert-own-module
    - BITRISE_STEP_VERSION: "0.9.9"
    - BITRISE_STEP_GIT_CLONE_URL: https://github.com/HuascarBaptista/bitrise-step-alert-own-module.git
    - MY_STEPLIB_REPO_FORK_GIT_URL: $MY_STEPLIB_REPO_FORK_GIT_URL

workflows:
  test:
    steps:
      - path::./:
          title: Env Vars
          inputs:
            - jira_keys: ${JIRA_KEYS}
            - folders: ${FOLDERS}
            - pr: ${PR}
            - path_configuration: ${PATH_CONFIGURATION}
            - branch: ${BRANCH}
      - script:
          title: Output (generated by the Step) tests
          inputs:
            - content: |-
                echo "-> ALERT_MESSAGE: ${ALERT_MESSAGE}"

  dep-update:
    title: Dep update
    description: |
      Used for updating bitrise dependencies with dep
    steps:
      - script:
          title: Dependency update
          inputs:
            - content: |-
                #!/bin/bash
                set -ex
                go get -u -v github.com/golang/dep/cmd/dep
                dep ensure -v
                dep ensure -v -update
  audit-this-step:
    steps:
      - script:
          inputs:
            - content: |-
                #!/bin/bash
                set -ex
                stepman audit --step-yml ./step.yml